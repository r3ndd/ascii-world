<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASCII World - Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #ccc;
            font-family: monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 {
            margin: 0 0 10px 0;
        }
        #game-container {
            border: 2px solid #444;
            margin: 10px 0;
        }
        #info {
            margin-top: 10px;
            font-size: 14px;
        }
        .controls {
            margin: 10px 0;
            padding: 10px;
            background: #111;
            border: 1px solid #333;
        }
        kbd {
            background: #333;
            padding: 2px 6px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>ASCII World Test</h1>
    <div id="game-container"></div>
    <div class="controls">
        <strong>Controls:</strong>
        <kbd>↑</kbd> <kbd>↓</kbd> <kbd>←</kbd> <kbd>→</kbd> or
        <kbd>w</kbd> <kbd>s</kbd> <kbd>a</kbd> <kbd>d</kbd> - Move
        <kbd>Space</kbd> - Wait
        <kbd>l</kbd> or <kbd>x</kbd> - Look Mode
    </div>
    <div class="controls">
        <strong>Look Mode:</strong>
        <kbd>Arrow Keys</kbd> - Move cursor
        <kbd>1-9</kbd> or <kbd>hotkeys</kbd> - Execute action
        <kbd>Esc</kbd> - Exit look mode
    </div>
    <div id="info">Loading...</div>

    <script type="module">
        import { Engine } from './dist/bundle.js';

        const info = document.getElementById('info');
        const container = document.getElementById('game-container');

        try {
            // Create and initialize the engine
            const engine = new Engine({
                display: {
                    width: 80,
                    height: 24,
                    fontSize: 16,
                    fontFamily: 'monospace',
                    forceSquareRatio: true
                },
                playerStartPosition: { x: 500, y: 500 },
                fovRadius: 15
            });

            await engine.initialize();

            // Add display to page
            const displayElement = engine.getContainer();
            container.appendChild(displayElement);

            // Create player
            engine.createPlayer({
                char: '@',
                fg: '#ffff00',
                maxHealth: 100,
                speed: 100
            });

            // Create NPC
            engine.createNPC({
                position: { x: 505, y: 505 },
                char: 'n',
                fg: '#ff0000',
                maxHealth: 50,
                speed: 80,
                aiType: 'random'
            });

            // Configure UI
            engine.setUIConfig({
                showTurnCounter: true,
                showPosition: true,
                showHealth: true
            });

            // Initial render
            engine.render();

            // Update info
            info.textContent = 'Engine initialized. Use arrow keys or WASD to move.';

            // Start the game
            engine.start();

        } catch (error) {
            console.error('Engine initialization error:', error);
            info.textContent = `Error: ${error.message}`;
        }
    </script>
</body>
</html>
